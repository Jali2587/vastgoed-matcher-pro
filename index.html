<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vastgoed Matcher Pro AI</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Simple icon components
        const PlusIcon = ({ size = 20, className = '' }) => React.createElement('svg', { 
          width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2', className 
        }, React.createElement('path', { d: 'M12 5v14M5 12h14' }));
        
        const UsersIcon = ({ size = 20, className = '' }) => React.createElement('svg', { 
          width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2', className 
        }, React.createElement('path', { d: 'M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2' }), React.createElement('circle', { cx: '9', cy: '7', r: '4' }), React.createElement('path', { d: 'M22 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75' }));
        
        const BuildingIcon = ({ size = 20, className = '' }) => React.createElement('svg', { 
          width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2', className 
        }, React.createElement('path', { d: 'M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z' }), React.createElement('path', { d: 'M6 12h4h4' }), React.createElement('path', { d: 'M6 20h4h4' }), React.createElement('path', { d: 'M10 4h4' }), React.createElement('path', { d: 'M10 8h4' }));
        
        const StarIcon = ({ size = 20, className = '' }) => React.createElement('svg', { 
          width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2', className 
        }, React.createElement('polygon', { points: '12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26' }));
        
        const MailIcon = ({ size = 20, className = '' }) => React.createElement('svg', { 
          width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2', className 
        }, React.createElement('path', { d: 'M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z' }), React.createElement('polyline', { points: '22,6 12,13 2,6' }));
        
        const PhoneIcon = ({ size = 20, className = '' }) => React.createElement('svg', { 
          width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2', className 
        }, React.createElement('path', { d: 'M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z' }));
        
        const MapPinIcon = ({ size = 20, className = '' }) => React.createElement('svg', { 
          width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2', className 
        }, React.createElement('path', { d: 'M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z' }), React.createElement('circle', { cx: '12', cy: '10', r: '3' }));
        
        const EuroIcon = ({ size = 20, className = '' }) => React.createElement('svg', { 
          width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2', className 
        }, React.createElement('path', { d: 'M18.5 6.5a9 9 0 0 0-9 9v0a9 9 0 0 0 9 9M6 12h9' }));
        
        const TrendingUpIcon = ({ size = 20, className = '' }) => React.createElement('svg', { 
          width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2', className 
        }, React.createElement('polyline', { points: '22,7 13.5,15.5 8.5,10.5 2,17' }), React.createElement('polyline', { points: '16,7 22,7 22,13' }));
        
        const LogOutIcon = ({ size = 20, className = '' }) => React.createElement('svg', { 
          width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2', className 
        }, React.createElement('path', { d: 'M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4' }), React.createElement('polyline', { points: '16,17 21,12 16,7' }), React.createElement('line', { x1: '21', y1: '12', x2: '9', y2: '12' }));
        
        const UserIcon = ({ size = 20, className = '' }) => React.createElement('svg', { 
          width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2', className 
        }, React.createElement('path', { d: 'M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2' }), React.createElement('circle', { cx: '12', cy: '7', r: '4' }));
        
        const BrainIcon = ({ size = 20, className = '' }) => React.createElement('svg', { 
          width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2', className 
        }, React.createElement('path', { d: 'M12 2a3 3 0 0 0-3 3 3 3 0 0 0-3 3v1a3 3 0 0 0 3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0 3-3V8a3 3 0 0 0-3-3 3 3 0 0 0-3-3z' }));
        
        const AlertCircleIcon = ({ size = 20, className = '' }) => React.createElement('svg', { 
          width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2', className 
        }, React.createElement('circle', { cx: '12', cy: '12', r: '10' }), React.createElement('line', { x1: '12', y1: '8', x2: '12', y2: '12' }), React.createElement('line', { x1: '12', y1: '16', x2: '12.01', y2: '16' }));
        
        const DollarSignIcon = ({ size = 20, className = '' }) => React.createElement('svg', { 
          width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2', className 
        }, React.createElement('line', { x1: '12', y1: '1', x2: '12', y2: '23' }), React.createElement('path', { d: 'M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6' }));
        
        const UserCheckIcon = ({ size = 20, className = '' }) => React.createElement('svg', { 
          width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2', className 
        }, React.createElement('path', { d: 'M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2' }), React.createElement('circle', { cx: '8.5', cy: '7', r: '4' }), React.createElement('polyline', { points: '17,11 19,13 23,9' }));
        
        const TargetIcon = ({ size = 20, className = '' }) => React.createElement('svg', { 
          width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2', className 
        }, React.createElement('circle', { cx: '12', cy: '12', r: '10' }), React.createElement('circle', { cx: '12', cy: '12', r: '6' }), React.createElement('circle', { cx: '12', cy: '12', r: '2' }));
        
        const TrashIcon = ({ size = 20, className = '' }) => React.createElement('svg', { 
          width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2', className 
        }, React.createElement('polyline', { points: '3,6 5,6 21,6' }), React.createElement('path', { d: 'M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2' }), React.createElement('line', { x1: '10', y1: '11', x2: '10', y2: '17' }), React.createElement('line', { x1: '14', y1: '11', x2: '14', y2: '17' }));

        const VastgoedInvesteerderMatcher = () => {
          const [user, setUser] = useState(null);
          const [activeTab, setActiveTab] = useState('dashboard');
          const [investors, setInvestors] = useState([]);
          const [deals, setDeals] = useState([]);
          const [transactions, setTransactions] = useState([]);
          const [users, setUsers] = useState([]);
          const [matches, setMatches] = useState([]);
          const [showAddInvestor, setShowAddInvestor] = useState(false);
          const [showAddDeal, setShowAddDeal] = useState(false);
          const [showAuth, setShowAuth] = useState(true);
          const [aiInsights, setAiInsights] = useState({});
          const [isLoadingAI, setIsLoadingAI] = useState(false);

          // Database functies
          const loadData = async () => {
            setUsers([
              { id: '1', name: 'Jan Vermeer', email: 'jan@example.com', company: 'Vermeer Vastgoed', role: 'agent' },
              { id: '2', name: 'Lisa de Vries', email: 'lisa@example.com', company: 'De Vries Properties', role: 'agent' },
              { id: '3', name: 'Mark Jansen', email: 'mark@example.com', company: 'Jansen Makelaars', role: 'manager' }
            ]);
            
            setInvestors([
              {
                id: '1',
                naam: 'Peter van der Berg',
                email: 'peter@example.com',
                telefoon: '06-12345678',
                bedrijf: 'Berg Investments',
                minBudget: 100000,
                maxBudget: 500000,
                voorkeursRegio: ['Nederland', 'Duitsland'],
                voorkeursLocaties: ['Amsterdam', 'Rotterdam', 'Haarlem', 'Berlijn', 'MÃ¼nchen'],
                vastgoedTypes: ['Appartement', 'Kantoor'],
                projectTypes: ['Turn-key', 'Renovatie'],
                risicoprofiel: 'Gemiddeld',
                gewenstRendement: 6,
                investeringshorizon: 'Lang termijn',
                ervaringLevel: 'Ervaren',
                beschikbaarheid: 'Direct',
                communicatieVoorkeur: 'Telefoon',
                investmentMotivatie: 'Uitbreiding van vastgoed portfolio voor pensioen opbouw',
                owner_id: '1',
                created_at: '2024-01-15T10:30:00Z'
              },
              {
                id: '2',
                naam: 'Maria Jansen',
                email: 'maria@example.com',
                telefoon: '06-87654321',
                bedrijf: 'Jansen Property',
                minBudget: 200000,
                maxBudget: 1000000,
                voorkeursRegio: ['Frankrijk', 'Spanje'],
                voorkeursLocaties: ['Utrecht', 'Den Haag', 'Parijs', 'Barcelona', 'Madrid'],
                vastgoedTypes: ['Appartement', 'Retail', 'Studenten'],
                projectTypes: ['Turn-key', 'Ontwikkeling'],
                risicoprofiel: 'Conservatief',
                gewenstRendement: 4,
                investeringshorizon: 'Middellang',
                ervaringLevel: 'Beginner',
                beschikbaarheid: '1-3 maanden',
                communicatieVoorkeur: 'Email',
                investmentMotivatie: 'Eerste stappen in vastgoed beleggen, focus op stabiele inkomsten',
                owner_id: '2',
                created_at: '2024-01-20T14:15:00Z'
              }
            ]);
            
            setDeals([
              {
                id: '1',
                titel: 'Modern Appartement Amsterdam',
                locatie: 'Amsterdam',
                type: 'Appartement',
                projectType: 'Turn-key',
                prijs: 350000,
                verwachtRendement: 5.5,
                risico: 'Gemiddeld',
                beschrijving: 'Kant-en-klaar nieuwbouw appartement in opkomende wijk Noord',
                oppervlakte: 85,
                bouwjaar: 2020,
                huurpotentie: 1800,
                status: 'Beschikbaar',
                bedrijfFonds: 'Vermeer Vastgoed B.V.',
                owner_id: '1',
                created_at: '2024-01-10T09:00:00Z'
              },
              {
                id: '2',
                titel: 'Kantoorpand Rotterdam',
                locatie: 'Rotterdam',
                type: 'Kantoor',
                projectType: 'Renovatie',
                prijs: 750000,
                verwachtRendement: 7.2,
                risico: 'Hoog',
                beschrijving: 'Kantoorpand voor renovatie in bedrijventerrein',
                oppervlakte: 400,
                bouwjaar: 2015,
                huurpotentie: 4500,
                status: 'Beschikbaar',
                bedrijfFonds: 'De Vries Properties N.V.',
                owner_id: '2',
                created_at: '2024-01-12T11:30:00Z'
              }
            ]);
            
            setTransactions([]);
            console.log('Demo data geladen');
          };

          const getUserById = (id) => {
            return users.find(u => u.id === id) || { name: 'Onbekend', email: '' };
          };

          // AI functies
          const callOpenAI = async (prompt, type = 'analysis') => {
            setIsLoadingAI(true);
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            const mockResponse = {
              fullAnalysis: `AI Analyse voor ${prompt.split(' ')[0]}: Dit is een professionele vastgoed analyse gebaseerd op de opgegeven gegevens. De AI heeft verschillende factoren geanalyseerd waaronder locatie, budget, risicoprofiel en marktomstandigheden.`,
              recommendations: ['Aanbeveling 1', 'Aanbeveling 2'],
              riskFactors: ['Risico 1', 'Risico 2'],
              opportunities: ['Kans 1', 'Kans 2']
            };
            
            setIsLoadingAI(false);
            return mockResponse;
          };

          const getInvestorInsights = async (investorId) => {
            const investor = investors.find(i => i.id === investorId);
            if (!investor) return;
            
            const insights = await callOpenAI(`Investeerder analyse voor ${investor.naam}`, 'investor_analysis');
            setAiInsights(prev => ({
              ...prev,
              [`investor_${investorId}`]: insights
            }));
          };

          const getDealInsights = async (dealId) => {
            const deal = deals.find(d => d.id === dealId);
            if (!deal) return;
            
            const insights = await callOpenAI(`Deal analyse voor ${deal.titel}`, 'deal_analysis');
            setAiInsights(prev => ({
              ...prev,
              [`deal_${dealId}`]: insights
            }));
          };

          // Login systeem
          const authenticateUser = (email, password) => {
            if (email === 'jmeelker26@gmail.com' && password === 'beheerder2024') {
              return {
                id: '1',
                name: 'J. Meelker',
                email: 'jmeelker26@gmail.com',
                company: 'Vastgoed Matcher Pro',
                role: 'beheerder'
              };
            }
            
            if (email === 'demo@vastgoed.nl' && password === 'demo123') {
              return {
                id: '2',
                name: 'Demo Gebruiker',
                email: 'demo@vastgoed.nl',
                company: 'Demo Company',
                role: 'agent'
              };
            }
            
            return null;
          };

          const handleLogin = async (credentials) => {
            try {
              const authenticatedUser = authenticateUser(credentials.email, credentials.password);
              
              if (authenticatedUser) {
                setUser(authenticatedUser);
                setShowAuth(false);
                await loadData();
              } else {
                alert('Onjuiste inloggegevens.');
              }
            } catch (error) {
              alert('Er ging iets mis bij het inloggen.');
            }
          };

          const handleLogout = () => {
            setUser(null);
            setShowAuth(true);
            setInvestors([]);
            setDeals([]);
            setTransactions([]);
            setUsers([]);
            setAiInsights({});
            setActiveTab('dashboard');
          };

          // Matching algoritme
          const calculateMatchScore = (investor, deal) => {
            let score = 0;
            
            // Budget matching
            if (deal.prijs >= investor.minBudget && deal.prijs <= investor.maxBudget) {
              score += 30;
            }
            
            // Locatie matching
            if (investor.voorkeursLocaties?.includes(deal.locatie)) {
              score += 25;
            }
            
            // Type matching
            if (investor.vastgoedTypes?.includes(deal.type)) {
              score += 20;
            }
            
            // Project type matching
            if (investor.projectTypes?.includes(deal.projectType)) {
              score += 15;
            }
            
            // Rendement matching
            if (deal.verwachtRendement >= investor.gewenstRendement) {
              score += 10;
            }
            
            return Math.min(score, 100);
          };

          const findMatches = (dealId) => {
            const deal = deals.find(d => d.id === dealId);
            if (!deal) return [];

            return investors.map(investor => ({
              investor,
              deal,
              matchScore: calculateMatchScore(investor, deal)
            })).sort((a, b) => b.matchScore - a.matchScore);
          };

          // Forms
          const handleAddInvestor = async (investorData) => {
            const newInvestor = {
              ...investorData,
              id: Date.now().toString(),
              owner_id: user.id,
              created_at: new Date().toISOString()
            };
            
            setInvestors(prev => [...prev, newInvestor]);
            setShowAddInvestor(false);
          };

          const handleAddDeal = async (dealData) => {
            const newDeal = {
              ...dealData,
              id: Date.now().toString(),
              owner_id: user.id,
              created_at: new Date().toISOString()
            };
            
            setDeals(prev => [...prev, newDeal]);
            setShowAddDeal(false);
          };

          const handleDeleteInvestor = (investorId) => {
            if (confirm('Weet je zeker dat je deze investeerder wilt verwijderen?')) {
              setInvestors(prev => prev.filter(i => i.id !== investorId));
            }
          };

          useEffect(() => {
            if (user) {
              loadData();
            }
          }, [user]);

          // Forms Components
          const InvestorForm = ({ onSubmit, onCancel }) => {
            const [formData, setFormData] = useState({
              naam: '',
              email: '',
              telefoon: '',
              bedrijf: '',
              minBudget: '',
              maxBudget: '',
              voorkeursRegio: [],
              voorkeursLocaties: [],
              vastgoedTypes: [],
              projectTypes: [],
              risicoprofiel: 'Gemiddeld',
              gewenstRendement: '',
              investeringshorizon: 'Middellang',
              ervaringLevel: 'Gemiddeld',
              investmentMotivatie: '',
              communicatieVoorkeur: 'Email',
              beschikbaarheid: 'Direct'
            });

            const handleSubmit = (e) => {
              e.preventDefault();
              onSubmit(formData);
            };

            const handleTypeChange = (type) => {
              setFormData(prev => ({
                ...prev,
                vastgoedTypes: prev.vastgoedTypes.includes(type)
                  ? prev.vastgoedTypes.filter(t => t !== type)
                  : [...prev.vastgoedTypes, type]
              }));
            };

            return (
              <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                <div className="bg-white rounded-lg w-full max-w-4xl max-h-[95vh] overflow-y-auto">
                  <div className="p-6 border-b">
                    <div className="flex items-center justify-between">
                      <h3 className="text-xl font-bold">Nieuwe Investeerder Toevoegen</h3>
                      <button onClick={onCancel} className="text-gray-400 hover:text-gray-600">â</button>
                    </div>
                  </div>
                  
                  <div className="p-6">
                    <form onSubmit={handleSubmit} id="investor-form">
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <div>
                          <label className="block text-sm font-medium mb-1">Naam *</label>
                          <input
                            type="text"
                            value={formData.naam}
                            onChange={(e) => setFormData({...formData, naam: e.target.value})}
                            className="w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                            required
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium mb-1">Email *</label>
                          <input
                            type="email"
                            value={formData.email}
                            onChange={(e) => setFormData({...formData, email: e.target.value})}
                            className="w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                            required
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium mb-1">Telefoon</label>
                          <input
                            type="tel"
                            value={formData.telefoon}
                            onChange={(e) => setFormData({...formData, telefoon: e.target.value})}
                            className="w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium mb-1">Bedrijf</label>
                          <input
                            type="text"
                            value={formData.bedrijf}
                            onChange={(e) => setFormData({...formData, bedrijf: e.target.value})}
                            className="w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium mb-1">Min Budget (â¬) *</label>
                          <input
                            type="number"
                            value={formData.minBudget}
                            onChange={(e) => setFormData({...formData, minBudget: parseInt(e.target.value)})}
                            className="w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                            required
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium mb-1">Max Budget (â¬) *</label>
                          <input
                            type="number"
                            value={formData.maxBudget}
                            onChange={(e) => setFormData({...formData, maxBudget: parseInt(e.target.value)})}
                            className="w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                            required
                          />
                        </div>
                      </div>

                      <div className="mb-4">
                        <label className="block text-sm font-medium mb-2">Vastgoed Types</label>
                        <div className="grid grid-cols-2 md:grid-cols-4 gap-2">
                          {['Appartement', 'Kantoor', 'Retail', 'Industrie', 'Woning', 'Hotel', 'Studenten', 'Zorgvastgoed'].map(type => (
                            <label key={type} className="flex items-center space-x-2 p-2 border rounded cursor-pointer hover:bg-gray-50">
                              <input
                                type="checkbox"
                                checked={formData.vastgoedTypes.includes(type)}
                                onChange={() => handleTypeChange(type)}
                                className="text-blue-600"
                              />
                              <span className="text-sm">{type}</span>
                            </label>
                          ))}
                        </div>
                      </div>
                    </form>
                  </div>
                  
                  <div className="p-6 border-t bg-gray-50 flex justify-end space-x-4">
                    <button
                      type="button"
                      onClick={onCancel}
                      className="px-6 py-2 text-gray-600 border rounded-md hover:bg-gray-100"
                    >
                      Annuleren
                    </button>
                    <button
                      type="submit"
                      form="investor-form"
                      className="px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"
                    >
                      Toevoegen
                    </button>
                  </div>
                </div>
              </div>
            );
          };

          const DealForm = ({ onSubmit, onCancel }) => {
            const [formData, setFormData] = useState({
              titel: '',
              locatie: '',
              type: '',
              projectType: '',
              prijs: '',
              verwachtRendement: '',
              risico: 'Gemiddeld',
              beschrijving: '',
              oppervlakte: '',
              bouwjaar: '',
              huurpotentie: '',
              status: 'Beschikbaar',
              bedrijfFonds: ''
            });

            const handleSubmit = (e) => {
              e.preventDefault();
              onSubmit(formData);
            };

            return (
              <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                <div className="bg-white rounded-lg w-full max-w-4xl max-h-[95vh] overflow-y-auto">
                  <div className="p-6 border-b">
                    <div className="flex items-center justify-between">
                      <h3 className="text-xl font-bold">Nieuwe Deal Toevoegen</h3>
                      <button onClick={onCancel} className="text-gray-400 hover:text-gray-600">â</button>
                    </div>
                  </div>
                  
                  <div className="p-6">
                    <form onSubmit={handleSubmit} id="deal-form">
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div>
                          <label className="block text-sm font-medium mb-1">Titel *</label>
                          <input
                            type="text"
                            value={formData.titel}
                            onChange={(e) => setFormData({...formData, titel: e.target.value})}
                            className="w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                            required
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium mb-1">Bedrijf/Fonds</label>
                          <input
                            type="text"
                            value={formData.bedrijfFonds}
                            onChange={(e) => setFormData({...formData, bedrijfFonds: e.target.value})}
                            className="w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="Naam van bedrijf of fonds"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium mb-1">Locatie *</label>
                          <select
                            value={formData.locatie}
                            onChange={(e) => setFormData({...formData, locatie: e.target.value})}
                            className="w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                            required
                          >
                            <option value="">Selecteer locatie</option>
                            <option value="Amsterdam">Amsterdam</option>
                            <option value="Rotterdam">Rotterdam</option>
                            <option value="Utrecht">Utrecht</option>
                            <option value="Den Haag">Den Haag</option>
                            <option value="Eindhoven">Eindhoven</option>
                          </select>
                        </div>
                        <div>
                          <label className="block text-sm font-medium mb-1">Type *</label>
                          <select
                            value={formData.type}
                            onChange={(e) => setFormData({...formData, type: e.target.value})}
                            className="w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                            required
                          >
                            <option value="">Selecteer type</option>
                            <option value="Appartement">Appartement</option>
                            <option value="Kantoor">Kantoor</option>
                            <option value="Retail">Retail</option>
                            <option value="Industrie">Industrie</option>
                          </select>
                        </div>
                        <div>
                          <label className="block text-sm font-medium mb-1">Project Type *</label>
                          <select
                            value={formData.projectType}
                            onChange={(e) => setFormData({...formData, projectType: e.target.value})}
                            className="w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                            required
                          >
                            <option value="">Selecteer project type</option>
                            <option value="Turn-key">Turn-key</option>
                            <option value="Renovatie">Renovatie</option>
                            <option value="Transformatie">Transformatie</option>
                            <option value="Ontwikkeling">Ontwikkeling</option>
                          </select>
                        </div>
                        <div>
                          <label className="block text-sm font-medium mb-1">Prijs (â¬) *</label>
                          <input
                            type="number"
                            value={formData.prijs}
                            onChange={(e) => setFormData({...formData, prijs: parseInt(e.target.value)})}
                            className="w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                            required
                          />
                        </div>
                      </div>
                      <div className="mb-4">
                        <label className="block text-sm font-medium mb-1">Beschrijving</label>
                        <textarea
                          value={formData.beschrijving}
                          onChange={(e) => setFormData({...formData, beschrijving: e.target.value})}
                          className="w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                          rows="3"
                        />
                      </div>
                    </form>
                  </div>
                  
                  <div className="p-6 border-t bg-gray-50 flex justify-end space-x-4">
                    <button
                      type="button"
                      onClick={onCancel}
                      className="px-6 py-2 text-gray-600 border rounded-md hover:bg-gray-100"
                    >
                      Annuleren
                    </button>
                    <button
                      type="submit"
                      form="deal-form"
                      className="px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"
                    >
                      Toevoegen
                    </button>
                  </div>
                </div>
              </div>
            );
          };

          // Auth Form
          const AuthForm = () => {
            const [formData, setFormData] = useState({
              email: '',
              password: ''
            });
            const [isLoading, setIsLoading] = useState(false);

            const handleSubmit = async (e) => {
              e.preventDefault();
              setIsLoading(true);
              
              try {
                await handleLogin(formData);
              } finally {
                setIsLoading(false);
              }
            };

            return (
              <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4">
                <div className="max-w-md w-full bg-white rounded-xl shadow-lg p-8">
                  <div className="text-center mb-8">
                    <h1 className="text-3xl font-bold text-gray-900 mb-2">ð  Vastgoed Matcher Pro</h1>
                    <p className="text-gray-600">Inloggen op je account</p>
                  </div>

                  <div className="mb-6 p-4 bg-blue-50 rounded-lg border">
                    <h4 className="font-semibold text-blue-800 mb-2">Demo Accounts</h4>
                    <div className="space-y-2 text-sm">
                      <div className="bg-white p-3 rounded border">
                        <p className="font-medium">Beheerder</p>
                        <p>Email: jmeelker26@gmail.com</p>
                        <p>Wachtwoord: beheerder2024</p>
                      </div>
                      <div className="bg-white p-3 rounded border">
                        <p className="font-medium">Demo</p>
                        <p>Email: demo@vastgoed.nl</p>
                        <p>Wachtwoord: demo123</p>
                      </div>
                    </div>
                  </div>

                  <form onSubmit={handleSubmit} className="space-y-4">
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Email</label>
                      <input
                        type="email"
                        value={formData.email}
                        onChange={(e) => setFormData({...formData, email: e.target.value})}
                        className="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                        required
                        disabled={isLoading}
                      />
                    </div>
                    
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Wachtwoord</label>
                      <input
                        type="password"
                        value={formData.password}
                        onChange={(e) => setFormData({...formData, password: e.target.value})}
                        className="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                        required
                        disabled={isLoading}
                      />
                    </div>
                    
                    <button
                      type="submit"
                      disabled={isLoading}
                      className="w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50"
                    >
                      {isLoading ? 'Bezig...' : 'Inloggen'}
                    </button>
                  </form>
                </div>
              </div>
            );
          };

          // Dashboard Component
          const Dashboard = () => {
            const userInvestors = investors.filter(i => i.owner_id === user.id);
            const userDeals = deals.filter(d => d.owner_id === user.id);

            return (
              <div>
                <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                  <div className="bg-white p-6 rounded-lg shadow-md">
                    <div className="flex items-center justify-between">
                      <div>
                        <p className="text-sm font-medium text-gray-600">Mijn Investeerders</p>
                        <p className="text-2xl font-bold text-gray-900">{userInvestors.length}</p>
                      </div>
                      <UsersIcon className="h-8 w-8 text-blue-600" />
                    </div>
                  </div>
                  
                  <div className="bg-white p-6 rounded-lg shadow-md">
                    <div className="flex items-center justify-between">
                      <div>
                        <p className="text-sm font-medium text-gray-600">Mijn Deals</p>
                        <p className="text-2xl font-bold text-gray-900">{userDeals.length}</p>
                      </div>
                      <BuildingIcon className="h-8 w-8 text-green-600" />
                    </div>
                  </div>
                  
                  <div className="bg-white p-6 rounded-lg shadow-md">
                    <div className="flex items-center justify-between">
                      <div>
                        <p className="text-sm font-medium text-gray-600">AI Analyses</p>
                        <p className="text-2xl font-bold text-gray-900">{Object.keys(aiInsights).length}</p>
                      </div>
                      <BrainIcon className="h-8 w-8 text-purple-600" />
                    </div>
                  </div>
                </div>

                <div className="bg-white rounded-lg shadow-md p-6">
                  <h3 className="text-lg font-semibold mb-4">Welkom bij Vastgoed Matcher Pro!</h3>
                  <p className="text-gray-600 mb-4">
                    Dit platform helpt je investeerders en deals te matchen met AI-powered analyse.
                  </p>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="p-4 bg-blue-50 rounded-lg">
                      <h4 className="font-semibold text-blue-800">Voeg Investeerders Toe</h4>
                      <p className="text-sm text-blue-600">Begin met het toevoegen van investeerders inclusief bedrijfsinformatie</p>
                    </div>
                    <div className="p-4 bg-green-50 rounded-lg">
                      <h4 className="font-semibold text-green-800">Maak Deals Aan</h4>
                      <p className="text-sm text-green-600">Voeg vastgoed deals toe met bedrijf/fonds informatie</p>
                    </div>
                  </div>
                </div>
              </div>
            );
          };

          // Show auth form if not logged in
          if (showAuth || !user) {
            return <AuthForm />;
          }

          return (
            <div className="max-w-7xl mx-auto p-6">
              <div className="mb-8 flex flex-col lg:flex-row justify-between items-start lg:items-center">
                <div>
                  <h1 className="text-3xl font-bold text-gray-900 mb-2">Vastgoed Matcher Pro AI</h1>
                  <p className="text-gray-600 mb-3">Welkom terug, {user.name}! ({user.role})</p>
                </div>
                <div className="flex items-center space-x-4 mt-4 lg:mt-0">
                  <div className="flex items-center space-x-2 text-gray-600">
                    <UserIcon size={16} />
                    <span>{user.company}</span>
                  </div>
                  <button
                    onClick={handleLogout}
                    className="flex items-center space-x-2 text-gray-600 hover:text-red-600 transition-colors"
                  >
                    <LogOutIcon size={16} />
                    <span>Uitloggen</span>
                  </button>
                </div>
              </div>

              <div className="flex space-x-2 mb-6 overflow-x-auto pb-2">
                <button
                  onClick={() => setActiveTab('dashboard')}
                  className={`px-4 py-2 rounded-lg flex items-center space-x-2 whitespace-nowrap transition-colors ${
                    activeTab === 'dashboard' ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                  }`}
                >
                  <TrendingUpIcon size={20} />
                  <span>Dashboard</span>
                </button>
                <button
                  onClick={() => setActiveTab('investors')}
                  className={`px-4 py-2 rounded-lg flex items-center space-x-2 whitespace-nowrap transition-colors ${
                    activeTab === 'investors' ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                  }`}
                >
                  <UsersIcon size={20} />
                  <span>Investeerders ({investors.length})</span>
                </button>
                <button
                  onClick={() => setActiveTab('deals')}
                  className={`px-4 py-2 rounded-lg flex items-center space-x-2 whitespace-nowrap transition-colors ${
                    activeTab === 'deals' ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                  }`}
                >
                  <BuildingIcon size={20} />
                  <span>Deals ({deals.length})</span>
                </button>
                <button
                  onClick={() => setActiveTab('matching')}
                  className={`px-4 py-2 rounded-lg flex items-center space-x-2 whitespace-nowrap transition-colors ${
                    activeTab === 'matching' ? 'bg-purple-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                  }`}
                >
                  <StarIcon size={20} />
                  <span>AI Matching</span>
                </button>
              </div>

              {activeTab === 'dashboard' && <Dashboard />}

              {activeTab === 'investors' && (
                <div>
                  <div className="flex justify-between items-center mb-6">
                    <h2 className="text-2xl font-bold">Investeerders</h2>
                    <button
                      onClick={() => setShowAddInvestor(true)}
                      className="bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-blue-700"
                    >
                      <PlusIcon size={20} />
                      <span>Nieuwe Investeerder</span>
                    </button>
                  </div>

                  <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    {investors.map(investor => (
                      <div key={investor.id} className="bg-white rounded-lg shadow-md p-6 border hover:shadow-lg transition-shadow">
                        <div className="flex items-center justify-between mb-4">
                          <h3 className="text-xl font-semibold text-gray-900">{investor.naam}</h3>
                          <span className={`px-2 py-1 rounded-full text-xs font-medium ${
                            investor.risicoprofiel === 'Conservatief' ? 'bg-green-100 text-green-800' :
                            investor.risicoprofiel === 'Gemiddeld' ? 'bg-yellow-100 text-yellow-800' :
                            'bg-red-100 text-red-800'
                          }`}>
                            {investor.risicoprofiel}
                          </span>
                        </div>

                        <div className="space-y-2 text-sm mb-4">
                          <div className="flex items-center space-x-2">
                            <UserCheckIcon size={16} className="text-gray-500" />
                            <span>Eigenaar: {getUserById(investor.owner_id).name}</span>
                          </div>
                          {investor.bedrijf && (
                            <div className="flex items-center space-x-2">
                              <BuildingIcon size={16} className="text-gray-500" />
                              <span className="font-medium">{investor.bedrijf}</span>
                            </div>
                          )}
                          <div className="flex items-center space-x-2">
                            <MailIcon size={16} className="text-gray-500" />
                            <span>{investor.email}</span>
                          </div>
                          <div className="flex items-center space-x-2">
                            <EuroIcon size={16} className="text-gray-500" />
                            <span>â¬{investor.minBudget.toLocaleString()} - â¬{investor.maxBudget.toLocaleString()}</span>
                          </div>
                        </div>

                        <div className="mt-4 pt-4 border-t space-y-2">
                          <button
                            onClick={() => getInvestorInsights(investor.id)}
                            disabled={isLoadingAI}
                            className="w-full bg-purple-600 text-white py-2 rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 flex items-center justify-center space-x-2"
                          >
                            <BrainIcon size={16} />
                            <span>{isLoadingAI ? 'AI Analyseert...' : 'AI Analyse'}</span>
                          </button>
                          
                          {(user.role === 'beheerder' || investor.owner_id === user.id) && (
                            <button
                              onClick={() => handleDeleteInvestor(investor.id)}
                              className="w-full bg-red-600 text-white py-2 rounded-lg hover:bg-red-700 transition-colors flex items-center justify-center space-x-2"
                            >
                              <TrashIcon size={16} />
                              <span>Verwijderen</span>
                            </button>
                          )}
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              )}

              {activeTab === 'deals' && (
                <div>
                  <div className="flex justify-between items-center mb-6">
                    <h2 className="text-2xl font-bold">Deals</h2>
                    <button
                      onClick={() => setShowAddDeal(true)}
                      className="bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-blue-700"
                    >
                      <PlusIcon size={20} />
                      <span>Nieuwe Deal</span>
                    </button>
                  </div>

                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                    {deals.map(deal => (
                      <div key={deal.id} className="bg-white rounded-lg shadow-md p-6 border hover:shadow-lg transition-shadow">
                        <div className="flex items-center justify-between mb-4">
                          <h3 className="text-xl font-semibold text-gray-900">{deal.titel}</h3>
                          <span className={`px-2 py-1 rounded-full text-xs font-medium ${
                            deal.risico === 'Laag' ? 'bg-green-100 text-green-800' :
                            deal.risico === 'Gemiddeld' ? 'bg-yellow-100 text-yellow-800' :
                            'bg-red-100 text-red-800'
                          }`}>
                            {deal.risico} risico
                          </span>
                        </div>

                        <div className="space-y-2 text-sm mb-4">
                          <div className="flex items-center space-x-2">
                            <UserCheckIcon size={16} className="text-gray-500" />
                            <span>Eigenaar: {getUserById(deal.owner_id).name}</span>
                          </div>
                          {deal.bedrijfFonds && (
                            <div className="flex items-center space-x-2">
                              <BuildingIcon size={16} className="text-gray-500" />
                              <span className="font-medium">{deal.bedrijfFonds}</span>
                            </div>
                          )}
                          <div className="flex items-center space-x-2">
                            <MapPinIcon size={16} className="text-gray-500" />
                            <span>{deal.locatie}</span>
                          </div>
                          <div className="flex items-center space-x-2">
                            <TargetIcon size={16} className="text-gray-500" />
                            <span>{deal.projectType}</span>
                          </div>
                          <div className="flex items-center space-x-2">
                            <EuroIcon size={16} className="text-gray-500" />
                            <span className="font-semibold">â¬{deal.prijs.toLocaleString()}</span>
                          </div>
                          <div className="flex items-center space-x-2">
                            <TrendingUpIcon size={16} className="text-gray-500" />
                            <span className="font-semibold text-green-600">{deal.verwachtRendement}% rendement</span>
                          </div>
                        </div>

                        <p className="text-sm text-gray-600 mb-4">{deal.beschrijving}</p>

                        <div className="space-y-2">
                          <button
                            onClick={() => {
                              setMatches(findMatches(deal.id));
                              setActiveTab('matching');
                            }}
                            className="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2"
                          >
                            <StarIcon size={16} />
                            <span>Vind Matches</span>
                          </button>
                          <button
                            onClick={() => getDealInsights(deal.id)}
                            disabled={isLoadingAI}
                            className="w-full bg-purple-600 text-white py-2 rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 flex items-center justify-center space-x-2"
                          >
                            <BrainIcon size={16} />
                            <span>{isLoadingAI ? 'AI Analyseert...' : 'AI Analyse'}</span>
                          </button>
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              )}

              {activeTab === 'matching' && (
                <div>
                  <h2 className="text-2xl font-bold mb-6">AI-Powered Matching</h2>
                  
                  {matches.length === 0 ? (
                    <div className="text-center py-12">
                      <AlertCircleIcon size={48} className="text-gray-400 mx-auto mb-4" />
                      <p className="text-gray-600 text-lg">Selecteer een deal om matches te vinden</p>
                      <p className="text-sm text-gray-500 mt-2">
                        Ga naar "Deals" tab â klik "Vind Matches" bij een deal
                      </p>
                    </div>
                  ) : (
                    <div className="space-y-6">
                      <div className="bg-blue-50 p-6 rounded-lg">
                        <h3 className="font-semibold text-lg mb-2">ð¯ Deal: {matches[0].deal.titel}</h3>
                        <p className="text-sm text-gray-600 mb-2">{matches[0].deal.beschrijving}</p>
                        <div className="flex items-center gap-4 text-sm">
                          <span className="text-blue-600 font-medium">Eigenaar: {getUserById(matches[0].deal.owner_id).name}</span>
                          {matches[0].deal.bedrijfFonds && (
                            <span className="text-gray-600">Bedrijf/Fonds: {matches[0].deal.bedrijfFonds}</span>
                          )}
                        </div>
                      </div>

                      {matches.map((match, index) => (
                        <div key={match.investor.id} className="bg-white rounded-lg shadow-md p-6 border">
                          <div className="flex items-center justify-between mb-4">
                            <div className="flex items-center space-x-4">
                              <span className="text-2xl font-bold text-blue-600">#{index + 1}</span>
                              <div>
                                <h3 className="text-xl font-semibold">{match.investor.naam}</h3>
                                <p className="text-sm text-gray-600">{match.investor.bedrijf}</p>
                              </div>
                            </div>
                            <div className="flex items-center space-x-4">
                              <span className={`px-4 py-2 rounded-full text-lg font-bold ${
                                match.matchScore >= 80 ? 'bg-green-100 text-green-800' :
                                match.matchScore >= 60 ? 'bg-yellow-100 text-yellow-800' :
                                'bg-red-100 text-red-800'
                              }`}>
                                {match.matchScore}% match
                              </span>
                            </div>
                          </div>

                          <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div>
                              <h4 className="font-semibold mb-3">Investeerder Details:</h4>
                              <div className="space-y-2 text-sm">
                                <p>Budget: â¬{match.investor.minBudget.toLocaleString()} - â¬{match.investor.maxBudget.toLocaleString()}</p>
                                <p>Gewenst rendement: {match.investor.gewenstRendement}%</p>
                                <p>Risicoprofiel: {match.investor.risicoprofiel}</p>
                                <p>Ervaring: {match.investor.ervaringLevel}</p>
                              </div>
                            </div>
                            <div>
                              <h4 className="font-semibold mb-3">Match Factoren:</h4>
                              <div className="space-y-1 text-sm">
                                <p>â Budget compatible</p>
                                <p>â Locatie interesse</p>
                                <p>â Type voorkeur</p>
                              </div>
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>
                  )}
                </div>
              )}

              {/* AI Insights Modal */}
              {Object.keys(aiInsights).length > 0 && (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                  <div className="bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto">
                    <div className="sticky top-0 bg-white border-b p-6 flex justify-between items-center">
                      <h4 className="text-xl font-bold flex items-center space-x-2">
                        <BrainIcon size={20} />
                        <span>AI Analyse</span>
                      </h4>
                      <button
                        onClick={() => setAiInsights({})}
                        className="text-gray-400 hover:text-gray-600 text-xl"
                      >
                        â
                      </button>
                    </div>
                    <div className="p-6">
                      {Object.entries(aiInsights).slice(-1).map(([key, insight]) => (
                        <div key={key} className="space-y-4">
                          <div className="bg-blue-50 p-4 rounded-lg">
                            <h3 className="font-bold text-lg mb-2 text-blue-900">
                              {key.includes('investor') ? 'ð¤ Investeerder Analyse' : 'ð¢ Deal Analyse'}
                            </h3>
                          </div>
                          
                          <div className="bg-white border rounded-lg p-4">
                            <h4 className="font-semibold text-gray-800 mb-3">ð¤ AI Analyse:</h4>
                            <p className="text-gray-700 leading-relaxed">{insight.fullAnalysis}</p>
                          </div>
                          
                          {insight.recommendations && (
                            <div className="bg-green-50 border border-green-200 rounded-lg p-4">
                              <h4 className="font-semibold text-green-800 mb-3">ð¡ Aanbevelingen:</h4>
                              <ul className="space-y-2">
                                {insight.recommendations.map((rec, idx) => (
                                  <li key={idx} className="flex items-start space-x-2">
                                    <span className="text-green-600 font-bold">â¢</span>
                                    <span className="text-green-700">{rec}</span>
                                  </li>
                                ))}
                              </ul>
                            </div>
                          )}
                        </div>
                      ))}
                    </div>
                  </div>
                </div>
              )}

              {showAddInvestor && (
                <InvestorForm
                  onSubmit={handleAddInvestor}
                  onCancel={() => setShowAddInvestor(false)}
                />
              )}

              {showAddDeal && (
                <DealForm
                  onSubmit={handleAddDeal}
                  onCancel={() => setShowAddDeal(false)}
                />
              )}
            </div>
          );
        };

        // Initialize the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(VastgoedInvesteerderMatcher));

        console.log('ð Vastgoed Matcher Pro AI - Clean Version Loaded!');
    </script>
</body>
</html>
